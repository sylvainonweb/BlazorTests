@using Syncfusion.EJ2.RazorComponents.DropDowns
@using System.ComponentModel.DataAnnotations
@using BlazorTests.Services
@using BlazorTests.Data
@using System.Linq
@inject BlazorTests.Services.JsInteropService JsInteropService
@inject BlazorTests.Services.ReferenceService ReferenceService




<EditForm Model="@this" OnValidSubmit="@Save">

    <div class="row">
        <div class="col-auto">
            <EjsDropDownList bind-value="@ActivityId" DataSource="@Activities" placeholder="Selectionner une activité" PopupHeight="220px">
                <DropDownListFieldSettings value="Id" text="Text"></DropDownListFieldSettings>
            </EjsDropDownList>
        </div>
        <div class="col-auto">
            <button type="submit">Sauvegarder</button>
        </div>
    </div>

    <DataAnnotationsValidator />
    <ValidationSummary />
</EditForm>


@functions {

    // [Required]
    //public string ActivityId { get; set; }
    //public IList<ActivityEntity> Activities { get; set; }

    [Required]
    public object ActivityId { get; set; }
    public IList<object> Activities { get; set; }

    protected override async Task OnInitAsync()
    {
        this.Activities = (await ReferenceService.GetActivityEntities())
            .Select(o => o as object).ToList();
    }

    public Task Save()
    {
        return JsInteropService.ShowAlert($"ActivityId = {this.ActivityId}");
    }
}
